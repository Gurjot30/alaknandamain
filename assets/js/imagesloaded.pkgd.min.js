function imagesLoaded(container, callback) {
  const elements = container.querySelectorAll("img");
  let loadedCount = 0;
  const total = elements.length;

  if (total === 0) {
    callback();
    return;
  }

  const checkDone = () => {
    loadedCount++;
    if (loadedCount === total) {
      callback();
    }
  };

  elements.forEach((img) => {
    if (img.complete && img.naturalWidth !== 0) {
      checkDone();
    } else {
      img.addEventListener("load", checkDone);
      img.addEventListener("error", checkDone); // Count errored images too
    }
  });
}
